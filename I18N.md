# Translation (i18n) System

This project uses i18next for internationalization (i18n), making it easy to support multiple languages.

## Current Supported Languages

- **English (en)** - Default language
- **Norwegian Bokmål (nb)** - Norwegian translation

## File Structure

```
src/
  locales/
    en/
      translation.json    # English translations
    nb/
      translation.json    # Norwegian translations
  js/
    i18n/
      index.ts           # i18n configuration and utilities
```

## How It Works

### 1. Translation Files

Translation files are JSON files located in `src/locales/{language-code}/translation.json`. Each file contains key-value pairs for all translatable text in the application.

Example structure:
```json
{
  "nav": {
    "home": "Home",
    "about": "About"
  },
  "hero": {
    "subtitle": "Fast, Secure and Forever Free."
  }
}
```

### 2. HTML Translation (Static Content)

Add `data-i18n` attributes to HTML elements:

```html
<h1 data-i18n="hero.title">The PDF Toolkit</h1>
<input data-i18n-placeholder="tools.searchPlaceholder" placeholder="Search..." />
```

Supported attributes:
- `data-i18n` - Translates element text content
- `data-i18n-html` - Translates element HTML content
- `data-i18n-placeholder` - Translates placeholder attribute
- `data-i18n-aria-label` - Translates aria-label attribute

### 3. JavaScript Translation (Dynamic Content)

Import the translation function:

```typescript
import { t } from './i18n/index.js';

// Use in code
const message = t('modals.processing');
const toolName = t('toolNames.merge');
```

### 4. Language Switcher

The language selector is automatically rendered in the navigation bar. It:
- Detects the user's browser language
- Stores the selected language in localStorage
- Updates all translations when changed

## Adding a New Language

Follow these steps to add support for a new language:

### Step 1: Create Translation File

1. Create a new folder in `src/locales/` with the language code (e.g., `de` for German, `fr` for French)
2. Copy `src/locales/en/translation.json` to your new folder
3. Translate all values (keep keys the same)

Example for German (`src/locales/de/translation.json`):
```json
{
  "nav": {
    "home": "Startseite",
    "about": "Über uns"
  }
}
```

### Step 2: Register the Language

Update `src/js/i18n/index.ts`:

```typescript
// Import the new translation
import deTranslation from '../locales/de/translation.json';

export const initI18n = async () => {
  await i18next
    .use(LanguageDetector)
    .init({
      // ... existing config
      supportedLngs: ['en', 'nb', 'de'], // Add your language code
      resources: {
        en: { translation: enTranslation },
        nb: { translation: nbTranslation },
        de: { translation: deTranslation }, // Add your language
      },
    });
};
```

### Step 3: Add Language to Selector

Update `index.html` to add the new language option:

```html
<div id="language-dropdown" class="...">
  <button data-lang="en" class="language-option ...">English</button>
  <button data-lang="nb" class="language-option ...">Norsk (Bokmål)</button>
  <button data-lang="de" class="language-option ...">Deutsch</button>
</div>
```

### Step 4: Test

1. Build the project: `npm run build`
2. Run dev server: `npm run dev`
3. Click the language selector and test your new language

## Translation Keys Reference

### Navigation
- `nav.home` - Home link
- `nav.about` - About link
- `nav.contact` - Contact link
- `nav.allTools` - All Tools link

### Hero Section
- `hero.subtitle` - Main subtitle
- `hero.noSignups` - No Signups badge
- `hero.unlimitedUse` - Unlimited Use badge
- `hero.worksOffline` - Works Offline badge
- `hero.cta` - Call to action button

### Features Section
- `features.noSignup.title` / `features.noSignup.description`
- `features.noUploads.title` / `features.noUploads.description`
- `features.foreverFree.title` / `features.foreverFree.description`
- And more...

### Tools
- `categories.{categoryname}` - Category names (lowercase, no spaces)
- `toolNames.{toolid}` - Tool names (tool ID without hyphens)
- `toolSubtitles.{toolid}` - Tool descriptions

### Modals
- `modals.processing` - Processing message
- `modals.alert` - Alert title
- `modals.ok` - OK button
- `modals.documentPreview` - Preview modal title

## Language Detection

The system automatically detects language in this order:
1. **localStorage** - Previously selected language
2. **Browser language** - User's browser/OS language
3. **Fallback** - English (en)

## Best Practices

1. **Keep keys consistent** - Never change translation keys, only values
2. **Use descriptive keys** - `hero.subtitle` is better than `text1`
3. **Test all languages** - Ensure UI doesn't break with longer translations
4. **Consider RTL languages** - If adding Arabic/Hebrew, you'll need additional CSS
5. **Keep translations short** - Some languages are more verbose than others

## Debugging

To see which keys are being accessed:

```typescript
// In src/js/i18n/index.ts
export const initI18n = async () => {
  await i18next
    .use(LanguageDetector)
    .init({
      debug: true, // Enable debug mode
      // ... rest of config
    });
};
```

This will log missing translations and key lookups to the console.

## Common Issues

### Translation not showing
- Check that the key exists in the translation file
- Verify the `data-i18n` attribute is correct
- Call `updatePageTranslations()` after dynamically adding elements

### New language not appearing
- Verify it's added to `supportedLngs` array
- Check import path is correct
- Rebuild the project

### Placeholder not translating
- Use `data-i18n-placeholder` instead of `data-i18n`
- Ensure `updatePageTranslations()` is called after page load
